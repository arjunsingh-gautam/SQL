# <span style="color:#a7c957">**Lesson-11 SQL**</span>

## <span style="color:#0a9396">**GROUP BY clause**</span>

## 1. Syntax of `GROUP BY`

```sql
SELECT column1, aggregate_function(column2)
FROM table_name
WHERE condition
GROUP BY column1;
```

- `column1`: the column you want to group by (like department).
- `aggregate_function`: e.g., `COUNT()`, `SUM()`, `AVG()`, `MAX()`, `MIN()`.

---

## 2. Working of `GROUP BY`

- Groups rows that have the **same value** in specified column(s).
- Returns **one row per group**.
- Often combined with aggregate functions to perform calculations on each group.

---

## 3. Use Cases

- Find total sales per customer.
- Count employees in each department.
- Find average marks per student.
- Summarize data into categories.

---

## 4. Best Practices

‚úÖ Always group by the **non-aggregated columns** you select.
‚úÖ Use `HAVING` (not `WHERE`) to filter groups after aggregation.
‚úÖ Keep grouping columns minimal for performance.
‚úÖ When grouping by multiple columns, order matters: `GROUP BY department, hire_date`.

---

## 5. Precautions

‚ö†Ô∏è If you select a non-aggregated column that‚Äôs not in `GROUP BY`, SQL will throw an error (except MySQL with `ONLY_FULL_GROUP_BY` off ‚Äî but don‚Äôt rely on that).
‚ö†Ô∏è Too many grouping columns = performance hit.
‚ö†Ô∏è Grouping large datasets requires indexes or summary tables for optimization.

---

## 6. Why does `GROUP BY` require aggregates?

- `GROUP BY` reduces **many rows ‚Üí one row per group**.
- To decide _what to show_ for non-grouped columns, we need **aggregates** (SUM, MAX, etc.).

üëâ Example:

```sql
SELECT department, salary
FROM Employees
GROUP BY department;
```

‚ö†Ô∏è Invalid ‚Äî because _which salary_ should SQL pick from that department?

‚úÖ Correct:

```sql
SELECT department, AVG(salary)
FROM Employees
GROUP BY department;
```

---

## 7. Can grouping be done without aggregation?

Yes ‚Äî but then it works like **`DISTINCT`**.

```sql
SELECT department
FROM Employees
GROUP BY department;
```

This simply returns **unique department names** (same as `SELECT DISTINCT department`).

---

## 8. Example Schema

```sql
CREATE TABLE Sales (
    sale_id INT PRIMARY KEY,
    customer_name VARCHAR(50),
    product VARCHAR(50),
    quantity INT,
    price DECIMAL(10,2),
    sale_date DATE
);

INSERT INTO Sales VALUES
(1, 'Arjun', 'Laptop', 1, 60000, '2023-01-10'),
(2, 'Arjun', 'Mouse', 2, 1200, '2023-01-15'),
(3, 'Riya', 'Laptop', 1, 60000, '2023-02-01'),
(4, 'Riya', 'Keyboard', 1, 2500, '2023-02-05'),
(5, 'Meera', 'Mouse', 3, 1800, '2023-03-12'),
(6, 'Karan', 'Laptop', 2, 120000, '2023-03-15'),
(7, 'Karan', 'Mouse', 1, 600, '2023-04-01');
```

---

## 9. Practice Questions

1. Find total quantity of products sold by each customer.
2. Find total sales (quantity √ó price) per customer.
3. Find how many times each product was sold.
4. Find the average price of items bought by each customer.
5. Find the customer who spent the maximum amount.
6. Show sales per month (group by month of `sale_date`).
7. Show which product type generated the highest total revenue.
8. Return unique customer names (using `GROUP BY` without aggregates).

---

üëâ Quick test for you:
If I want to see the **total revenue generated by each product**, what would the `SELECT` + `GROUP BY` look like?
